<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VoyagerVerse - Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #1a56db;
            --primary-light: #4285F4;
            --accent-color: #f59e0b;
            --text-color: #333;
            --text-light: #6b7280;
            --bg-color: #f0f5ff;
            --card-bg: #ffffff;
            --border-color: #e5e7eb;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Roboto', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
        }
        
        .navbar {
            background-color: var(--primary-color);
            color: white;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            font-size: 1.5rem;
            font-weight: 700;
        }
        
        .logo span {
            color: var(--accent-color);
        }
        
        .nav-links {
            display: flex;
            gap: 2rem;
        }
        
        .nav-links a {
            color: white;
            text-decoration: none;
            font-weight: 500;
        }
        
        .container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 1rem;
        }
        
        .welcome-card {
            display: flex;
            background-color: var(--card-bg);
            border-radius: 0.5rem;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            margin-bottom: 2rem;
        }
        
        .welcome-image {
            width: 40%;
            background-color: var(--primary-light);
            padding: 2rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .welcome-content {
            padding: 2rem;
            flex: 1;
        }
        
        .welcome-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 1rem;
        }
        
        .welcome-text {
            color: var(--text-light);
            margin-bottom: 1.5rem;
            line-height: 1.6;
        }
        
        .btn {
            display: inline-block;
            padding: 0.5rem 1rem;
            background-color: var(--primary-color);
            color: white;
            border-radius: 0.25rem;
            text-decoration: none;
            font-weight: 500;
            cursor: pointer;
        }
        
        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
        }
        
        .card {
            background-color: var(--card-bg);
            border-radius: 0.5rem;
            padding: 1.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }
        
        .card-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .card-date {
            font-size: 0.9rem;
            color: var(--text-light);
            font-weight: normal;
        }
        
        .weather-display {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 1rem 0;
        }
        
        .weather-temp {
            font-size: 3rem;
            font-weight: 700;
        }
        
        .weather-condition {
            margin-top: 0.5rem;
            color: var(--text-light);
        }
        
        .activity-item {
            padding: 1rem;
            border-bottom: 1px solid var(--border-color);
        }
        
        .activity-item:last-child {
            border-bottom: none;
        }
        
        .activity-time {
            font-weight: 500;
            margin-bottom: 0.25rem;
        }
        
        .activity-name {
            font-weight: 600;
        }
        
        .activity-location {
            color: var(--text-light);
            font-size: 0.9rem;
        }
        
        .activity-alert {
            background-color: #fef2f2;
            border-left: 3px solid #ef4444;
            padding: 0.5rem;
            margin-top: 0.5rem;
            font-size: 0.9rem;
            color: #b91c1c;
        }
        
        .activity-update {
            background-color: #ecfdf5;
            border-left: 3px solid #10b981;
            padding: 0.5rem;
            margin-top: 0.5rem;
            font-size: 0.9rem;
            color: #047857;
        }
        
        .loading {
            text-align: center;
            color: var(--text-light);
            padding: 2rem 0;
        }
        
        /* Tool Calling Visualization */
        .tool-call-log {
            margin-top: 2rem;
            background-color: var(--card-bg);
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            overflow: hidden;
        }
        
        .tool-call-header {
            background-color: var(--primary-color);
            color: white;
            padding: 1rem 1.5rem;
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .tool-call-content {
            max-height: 400px;
            overflow-y: auto;
            padding: 1rem 1.5rem;
        }
        
        .tool-call {
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-color);
        }
        
        .tool-call:last-child {
            border-bottom: none;
        }
        
        .tool-call-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
        }
        
        .tool-call-title span {
            margin-right: 0.5rem;
        }
        
        .tool-call-details {
            background-color: #f9fafb;
            padding: 0.75rem;
            border-radius: 0.25rem;
            font-family: monospace;
            font-size: 0.9rem;
            white-space: pre-wrap;
        }
        
        .tool-call-perception {
            border-left: 3px solid #3b82f6;
        }
        
        .tool-call-reasoning {
            border-left: 3px solid #8b5cf6;
        }
        
        .tool-call-action {
            border-left: 3px solid #ef4444;
        }
        
        .tool-call-learning {
            border-left: 3px solid #10b981;
        }
        
        .btn-tool-call {
            background-color: var(--primary-light);
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="logo">Voyager<span>Verse</span></div>
        <div class="nav-links">
            <a href="#">Dashboard</a>
            <a href="#">Itinerary</a>
            <a href="#">Preferences</a>
            <a href="#">Help</a>
        </div>
    </nav>
    
    <div class="container">
        <div class="welcome-card">
            <div class="welcome-image">
                <!-- Placeholder for traveler image -->
                <svg width="200" height="200" viewBox="0 0 200 200" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect width="200" height="200" fill="#4285F4"/>
                    <circle cx="70" cy="80" r="20" fill="#FFA726"/>
                    <circle cx="130" cy="80" r="20" fill="#FFA726"/>
                    <rect x="50" y="120" width="100" height="40" rx="20" fill="#FFA726"/>
                </svg>
            </div>
            <div class="welcome-content">
                <h1 class="welcome-title">Welcome to Dubai, {{ traveler_name }}</h1>
                <p class="welcome-text">
                    Your agentic AI travel assistant is continuously monitoring conditions and preferences to ensure you have the perfect Dubai experience. Enjoy personalized recommendations that adapt in real-time to weather, your energy levels, and changing preferences.
                </p>
                <a href="#" class="btn" id="view-plan-btn">View Today's Plan</a>
            </div>
        </div>
        
        <div class="grid">
            <div class="card">
                <div class="card-title">
                    Today's Itinerary
                    <span class="card-date">{{ current_date }}</span>
                </div>
                <div id="itinerary-content">
                    <div class="loading">No activities scheduled yet. Click 'View Today's Plan' to load your itinerary.</div>
                </div>
            </div>
            
            <div class="card">
                <div class="card-title">
                    Weather Conditions
                    <span class="card-date">Real-time updates</span>
                </div>
                <div id="weather-content">
                    <div class="weather-display">
                        <div class="weather-temp">--Â°C</div>
                        <div class="weather-condition">Loading...</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Tool Calling Visualization (Hidden by default) -->
        <div class="tool-call-log" id="tool-call-log" style="display: none;">
            <div class="tool-call-header">
                <div>Agentic AI Tool Calling</div>
                <button class="btn btn-tool-call" id="run-tool-calls">Run Tool Calling Demo</button>
            </div>
            <div class="tool-call-content" id="tool-call-content"></div>
        </div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const viewPlanBtn = document.getElementById('view-plan-btn');
            const itineraryContent = document.getElementById('itinerary-content');
            const weatherContent = document.getElementById('weather-content');
            const toolCallLog = document.getElementById('tool-call-log');
            const runToolCallsBtn = document.getElementById('run-tool-calls');
            const toolCallContent = document.getElementById('tool-call-content');
            
            // Sample data (would come from backend in real implementation)
            const weatherData = {
                temperature: 44,
                condition: 'Sunny',
                feels_like: 47,
                humidity: 28,
                wind_speed: 12
            };
            
            const originalItinerary = [
                { time: '09:00-10:30', activity: 'Breakfast at Hotel', location: 'Burj Al Arab', is_outdoor: false },
                { time: '11:00-15:00', activity: 'Desert Safari', location: 'Dubai Desert Conservation Reserve', is_outdoor: true },
                { time: '16:00-18:00', activity: 'Relaxation Time', location: 'Hotel', is_outdoor: false },
                { time: '19:00-21:00', activity: 'Dinner Cruise', location: 'Dubai Marina', is_outdoor: false }
            ];
            
            const updatedItinerary = [
                { time: '09:00-10:30', activity: 'Breakfast at Hotel', location: 'Burj Al Arab', is_outdoor: false },
                { time: '11:00-13:00', activity: 'Dubai Museum Visit', location: 'Al Fahidi Fort', is_outdoor: false, updated: true },
                { time: '13:30-15:00', activity: 'Lunch at Arabian Tea House', location: 'Al Fahidi District', is_outdoor: false, updated: true },
                { time: '16:00-18:00', activity: 'Relaxation Time', location: 'Hotel', is_outdoor: false },
                { time: '19:00-21:00', activity: 'Dinner Cruise', location: 'Dubai Marina', is_outdoor: false }
            ];
            
            // View Plan button click
            viewPlanBtn.addEventListener('click', function(e) {
                e.preventDefault();
                
                // Display weather
                weatherContent.innerHTML = `
                    <div class="weather-display">
                        <div class="weather-temp">${weatherData.temperature}Â°C</div>
                        <div class="weather-condition">${weatherData.condition}</div>
                        <div class="weather-condition">Feels like: ${weatherData.feels_like}Â°C</div>
                        <div class="weather-condition">Humidity: ${weatherData.humidity}%</div>
                    </div>
                    <div class="activity-alert">
                        <strong>Weather Alert:</strong> Extreme heat warning. Outdoor activities may be unsafe during mid-day.
                    </div>
                `;
                
                // Display original itinerary
                let itineraryHTML = '';
                originalItinerary.forEach(item => {
                    itineraryHTML += `
                        <div class="activity-item">
                            <div class="activity-time">${item.time}</div>
                            <div class="activity-name">${item.activity}</div>
                            <div class="activity-location">${item.location}</div>
                            ${item.is_outdoor && weatherData.temperature > 40 ? 
                                `<div class="activity-alert">Warning: Outdoor activity during extreme heat</div>` : ''}
                        </div>
                    `;
                });
                itineraryContent.innerHTML = itineraryHTML;
                
                // Show tool calling log
                toolCallLog.style.display = 'block';
                
                // Scroll to tool calling section
                toolCallLog.scrollIntoView({ behavior: 'smooth' });
            });
            
            // Run Tool Calls button click
            runToolCallsBtn.addEventListener('click', function() {
                // Clear previous tool calls
                toolCallContent.innerHTML = '';
                runToolCallsBtn.disabled = true;
                
                // Add initial message
                addToolCall('system', 'Starting agentic AI workflow for Tom & Priya...');
                
                // Perception phase
                setTimeout(() => {
                    addToolCall('perception', 'get_weather("Dubai")', 
                        JSON.stringify(weatherData, null, 2));
                    
                    setTimeout(() => {
                        addToolCall('perception', 'get_itinerary("Tom_and_Priya")', 
                            JSON.stringify(originalItinerary, null, 2));
                        
                        // Reasoning phase
                        setTimeout(() => {
                            addToolCall('reasoning', 'analyze_safety({"activity": "Desert Safari", "temperature": 44})', 
                                JSON.stringify({
                                    is_safe: false,
                                    risk_level: "High",
                                    reason: "Temperature exceeds safety threshold for outdoor activities (>40Â°C)",
                                    recommendation: "Reschedule or find indoor alternative"
                                }, null, 2));
                            
                            setTimeout(() => {
                                addToolCall('reasoning', 'find_alternatives({"type": "indoor", "preferences": ["cultural"]})', 
                                    JSON.stringify([
                                        { name: "Dubai Museum", type: "cultural", location: "Al Fahidi Fort" },
                                        { name: "Mall of the Emirates", type: "shopping", location: "Sheikh Zayed Road" },
                                        { name: "Burj Khalifa Observation Deck", type: "attraction", location: "Downtown Dubai" }
                                    ], null, 2));
                                
                                // Action phase
                                setTimeout(() => {
                                    addToolCall('action', 'cancel_booking({"activity": "Desert Safari"})', 
                                        JSON.stringify({
                                            success: true,
                                            refund_status: "Full refund processed",
                                            confirmation: "CXL78901"
                                        }, null, 2));
                                    
                                    setTimeout(() => {
                                        addToolCall('action', 'book_activity({"activity": "Dubai Museum", "time": "11:00-13:00"})', 
                                            JSON.stringify({
                                                success: true,
                                                booking_id: "DM54321",
                                                confirmation: "BKG12345"
                                            }, null, 2));
                                        
                                        // Learning phase
                                        setTimeout(() => {
                                            addToolCall('learning', 'update_preferences({"avoid_outdoor_high_heat": true})', 
                                                JSON.stringify({
                                                    success: true,
                                                    updated_preferences: ["avoid_outdoor_high_heat"]
                                                }, null, 2));
                                            
                                            // Update itinerary display
                                            setTimeout(() => {
                                                let itineraryHTML = '';
                                                updatedItinerary.forEach(item => {
                                                    itineraryHTML += `
                                                        <div class="activity-item">
                                                            <div class="activity-time">${item.time}</div>
                                                            <div class="activity-name">${item.activity}</div>
                                                            <div class="activity-location">${item.location}</div>
                                                            ${item.updated ? 
                                                                `<div class="activity-update">Updated: Indoor alternative due to extreme heat</div>` : ''}
                                                        </div>
                                                    `;
                                                });
                                                itineraryContent.innerHTML = itineraryHTML;
                                                
                                                // Complete
                                                addToolCall('system', 'Agentic AI workflow complete. Itinerary updated to ensure safety during extreme heat.');
                                                runToolCallsBtn.disabled = false;
                                            }, 1000);
                                        }, 2000);
                                    }, 2000);
                                }, 2000);
                            }, 2000);
                        }, 2000);
                    }, 2000);
                }, 1000);
            });
            
            // Helper function to add tool calls to the log
            function addToolCall(type, title, details = '') {
                const toolCall = document.createElement('div');
                toolCall.className = 'tool-call';
                
                let icon = '';
                let className = '';
                
                switch(type) {
                    case 'perception':
                        icon = 'ðï¸';
                        className = 'tool-call-perception';
                        break;
                    case 'reasoning':
                        icon = 'ð§ ';
                        className = 'tool-call-reasoning';
                        break;
                    case 'action':
                        icon = 'â¡';
                        className = 'tool-call-action';
                        break;
                    case 'learning':
                        icon = 'ð';
                        className = 'tool-call-learning';
                        break;
                    case 'system':
                        icon = 'ð¤';
                        break;
                }
                
                toolCall.innerHTML = `
                    <div class="tool-call-title">
                        <span>${icon}</span> ${title}
                    </div>
                    ${details ? `<div class="tool-call-details ${className}">${details}</div>` : ''}
                `;
                
                toolCallContent.appendChild(toolCall);
                toolCallContent.scrollTop = toolCallContent.scrollHeight;
            }
        });
    </script>
</body>
</html>
